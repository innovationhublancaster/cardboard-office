!function(){function t(t){i=t}function n(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}return window.orientation||0}function e(){o=n()}var i={},o=window.orientation||0;window.addEventListener("deviceorientation",t,!1),window.addEventListener("orientationchange",e,!1),THREE.DeviceOrientationControls=function(t){this.object=t,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.movementSpeed=1,this.rollSpeed=.005,this.autoAlign=!0,this.autoForward=!1,this.alpha=0,this.beta=0,this.gamma=0,this.orient=0,this.alignQuaternion=new THREE.Quaternion,this.orientationQuaternion=new THREE.Quaternion;var n=new THREE.Quaternion,e=new THREE.Quaternion,a=new THREE.Vector3,r=new THREE.Matrix4,s=new THREE.Euler(0,0,0,"YXZ"),h=new THREE.Quaternion,u=new THREE.Vector3(0,0,1),E=new THREE.Vector3(0,1,0),c=new THREE.Vector3(0,0,0),l=new THREE.Euler,d=new THREE.Quaternion,w=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));this.update=function(t){return function(t){this.freeze||(this.alpha=i.gamma?THREE.Math.degToRad(i.alpha):0,this.beta=i.beta?THREE.Math.degToRad(i.beta):0,this.gamma=i.gamma?THREE.Math.degToRad(i.gamma):0,this.orient=o?THREE.Math.degToRad(o):0,l.set(this.beta,this.alpha,-this.gamma,"YXZ"),n.setFromEuler(l),e.slerp(n,.5),this.autoAlign?this.orientationQuaternion.copy(n):this.orientationQuaternion.copy(e),this.orientationQuaternion.multiply(w),this.orientationQuaternion.multiply(d.setFromAxisAngle(u,-this.orient)),this.object.quaternion.copy(this.alignQuaternion),this.object.quaternion.multiply(this.orientationQuaternion),this.autoForward&&(a.set(0,0,-1).applyQuaternion(this.object.quaternion,"ZXY").setLength(this.movementSpeed/50),this.object.position.add(a)),this.autoAlign&&0!==this.alpha&&(this.autoAlign=!1,this.align()))}}(),this.align=function(){a.set(0,0,-1).applyQuaternion(h.copy(this.orientationQuaternion).inverse(),"ZXY"),s.setFromQuaternion(h.setFromRotationMatrix(r.lookAt(a,c,E))),s.set(0,s.y,0),this.alignQuaternion.setFromEuler(s)},this.connect=function(){this.freeze=!1},this.disconnect=function(){this.freze=!0}}}();