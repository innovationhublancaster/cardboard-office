THREE.StereoEffect=function(t){this.separation=3,this.focalLength=15;var e,a,r=new THREE.Vector3,o=new THREE.Quaternion,n=new THREE.Vector3,i=new THREE.PerspectiveCamera,s=new THREE.PerspectiveCamera,p,c,E,h,d,u,T,f,R,l;t.autoClear=!1,this.setSize=function(r,o){e=r/2,a=o,t.setSize(r,o)},this.render=function(M,H){M.updateMatrixWorld(),void 0===H.parent&&H.updateMatrixWorld(),H.matrixWorld.decompose(r,o,n),p=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(H.fov)))),u=H.near/this.focalLength,f=Math.tan(.5*THREE.Math.degToRad(p))*this.focalLength,T=.5*f*H.aspect,h=f*u,d=-h,R=(T+this.separation/2)/(2*T),l=1-R,c=2*T*u*l,E=2*T*u*R,i.projectionMatrix.makeFrustum(-c,E,d,h,H.near,H.far),i.position.copy(r),i.quaternion.copy(o),i.translateX(-this.separation/2),s.projectionMatrix.makeFrustum(-E,c,d,h,H.near,H.far),s.position.copy(r),s.quaternion.copy(o),s.translateX(this.separation/2),t.setViewport(0,0,2*e,a),t.clear(),t.setViewport(0,0,e,a),t.render(M,i),t.setViewport(e,0,e,a),t.render(M,s)}};